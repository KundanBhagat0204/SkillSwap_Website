<div class="dashboard-container">
    <aside class="dashboard-sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">Dashboard</h2>
        </div>

        <nav class="sidebar-nav">
            <a routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
                class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                    </path>
                </svg>
                <span>Overview</span>
            </a>

            <a routerLink="/dashboard/orders" routerLinkActive="active" class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2">
                    </path>
                </svg>
                <span>Orders</span>
            </a>

            <a routerLink="/mentors" class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z">
                    </path>
                </svg>
                <span>Find Mentors</span>
            </a>

            <a routerLink="/booking" class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                    </path>
                </svg>
                <span>Book Session</span>
            </a>

            <a routerLink="/messages" class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z">
                    </path>
                </svg>
                <span>Messages</span>
            </a>

            <a class="nav-item w-full text-left bg-transparent border-0 cursor-pointer" routerLink="/dashboard"
                fragment="referral" (click)="scrollToReferral()">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
                <span>Refer & Earn</span>
            </a>

            <div class="nav-divider"></div>

            <a routerLink="/chatbot" class="nav-item">
                <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z">
                    </path>
                </svg>
                <span>AI Assistant</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="dashboard-main">
        <div class="dashboard-header">
            <div>
                <p class="breadcrumb">Home / Dashboard</p>
                <h1 class="page-title">Welcome Back!</h1>
                <p class="page-subtitle">Here's what's happening with your mentorship space today.</p>
            </div>
            <div class="header-actions">
                <a routerLink="/dashboard/orders" class="btn-outline">Go to Sessions</a>
                <button *ngIf="isMentor" class="btn-primary" type="button" (click)="scrollToReferral()">
                    <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Refer & Earn
                </button>
            </div>
        </div>

        <section class="summary-grid">
            <article *ngFor="let card of summaryCards" class="summary-card" [ngClass]="card.accent">
                <div class="summary-meta">
                    <p class="summary-label">{{ card.title }}</p>
                    <span class="summary-delta">{{ card.delta }}</span>
                </div>
                <div class="summary-value">{{ card.value }}</div>
                <p class="summary-info">{{ card.info }}</p>
                <a [routerLink]="card.link" class="summary-link">
                    View details
                    <svg viewBox="0 0 24 24">
                        <path d="M9 5l7 7-7 7" />
                    </svg>
                </a>
            </article>
        </section>

        <section class="quick-actions">
            <h2>Quick actions</h2>
            <div class="quick-grid">
                <a *ngFor="let action of quickActions" [routerLink]="action.link" class="quick-card"
                    [ngClass]="action.accent">
                    <div>
                        <p class="quick-label">{{ action.label }}</p>
                        <p class="quick-desc">{{ action.description }}</p>
                    </div>
                    <span class="quick-pill">Open</span>
                </a>
            </div>
        </section>

        <section class="referral-section card" *ngIf="isMentor" #referralSection>
            <header class="card-header">
                <div>
                    <p class="card-kicker">Refer & Earn</p>
                    <h3>Invite mentees with Golden Tickets</h3>
                </div>
            </header>
            <app-referral-modal></app-referral-modal>
        </section>

        <section class="insights-grid">
            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Weekly Sessions</p>
                        <h3>Mentor activity snapshot</h3>
                    </div>
                    <span class="badge">Live</span>
                </header>
                <div class="indigo-accent-bar"></div>
                <p class="chart-legend">Indigo bars = completed sessions</p>
                <div class="bar-chart">
                    <div *ngFor="let day of weeklySessions" class="bar-col">
                        <span class="bar" [style.height.%]="getSessionBarHeight(day.completed)"></span>
                        <p class="bar-label">{{ day.day }}</p>
                        <p class="bar-value">{{ day.completed }}</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Community mix</p>
                        <h3>Mentor vs Mentee</h3>
                    </div>
                    <a routerLink="/mentors" class="link">Manage</a>
                </header>
                <p class="chart-legend">Purple slice = mentors, Pink slice = mentees</p>
                <div class="donut-wrapper">
                    <div class="donut"></div>
                    <ul>
                        <li *ngFor="let entry of mentorVsMentee">
                            <span class="dot"></span>
                            {{ entry.label }} · {{ entry.value }} ({{ getMixPercentage(entry.value) }}%)
                        </li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">People spotlight</p>
                        <h3>User activity</h3>
                    </div>
                </header>
                <ul class="highlight-list">
                    <li *ngFor="let highlight of userHighlights">
                        <div>
                            <p class="highlight-name">{{ highlight.name }}</p>
                            <p class="highlight-role">{{ highlight.role }}</p>
                        </div>
                        <div class="highlight-status">
                            <span>{{ highlight.status }}</span>
                            <small>{{ highlight.time }}</small>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Session roadmap</p>
                        <h3>Next 24 hours</h3>
                    </div>
                    <a routerLink="/dashboard/orders" class="link">See all</a>
                </header>
                <div class="roadmap">
                    <article *ngFor="let session of sessionRoadmap" class="roadmap-item">
                        <div>
                            <p class="roadmap-title">{{ session.title }}</p>
                            <p class="roadmap-meta">{{ session.mentor }} → {{ session.mentee }}</p>
                        </div>
                        <span class="roadmap-time">{{ session.time }}</span>
                    </article>
                </div>
            </div>
        </section>

        <section class="leaderboard-and-stats">
            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Mentor leaderboard</p>
                        <h3>Most booked this week</h3>
                    </div>
                    <span class="badge">Top 3</span>
                </header>
                <ul class="leaderboard">
                    <li *ngFor="let mentor of mentorLeaderboard; index as idx">
                        <span class="rank">#{{ idx + 1 }}</span>
                        <div>
                            <p class="leader-name">{{ mentor.name }}</p>
                            <p class="leader-meta">{{ mentor.speciality }}</p>
                        </div>
                        <div class="leader-score">
                            <span>{{ mentor.sessions }} sessions</span>
                            <small>{{ mentor.score }} ★</small>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="card">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">User leaderboard</p>
                        <h3>Power mentees</h3>
                    </div>
                    <a routerLink="/mentees" class="link">View all</a>
                </header>
                <ul class="leaderboard">
                    <li *ngFor="let mentee of menteeLeaderboard; index as idx">
                        <span class="rank">#{{ idx + 1 }}</span>
                        <div>
                            <p class="leader-name">{{ mentee.name }}</p>
                            <p class="leader-meta">{{ mentee.focus }}</p>
                        </div>
                        <div class="leader-score">
                            <span>{{ mentee.visits }} visits</span>
                            <small>{{ mentee.rebookRate }}% rebook</small>
                        </div>
                    </li>
                </ul>
            </div>
        </section>

        <section class="stats-duo">
            <div class="card compact">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Traffic snapshot</p>
                        <h3>Visitor funnel</h3>
                    </div>
                </header>
                <div class="stat-grid">
                    <div>
                        <p class="stat-label">Total visits</p>
                        <p class="stat-value">{{ visitStats.totalVisits }}</p>
                    </div>
                    <div>
                        <p class="stat-label">New visits</p>
                        <p class="stat-value">+{{ visitStats.newVisits }}</p>
                    </div>
                    <div>
                        <p class="stat-label">Sessions booked</p>
                        <p class="stat-value">{{ visitStats.sessionBooked }}</p>
                    </div>
                    <div>
                        <p class="stat-label">Sessions rebooked</p>
                        <p class="stat-value">{{ visitStats.sessionRebooked }}</p>
                    </div>
                </div>
            </div>

            <div class="card compact">
                <header class="card-header">
                    <div>
                        <p class="card-kicker">Mentor capacity</p>
                        <h3>Session efficiency</h3>
                    </div>
                </header>
                <div class="stat-grid">
                    <div>
                        <p class="stat-label">Conducted</p>
                        <p class="stat-value">{{ mentorSessionStats.conducted }}</p>
                    </div>
                    <div>
                        <p class="stat-label">Rebooked</p>
                        <p class="stat-value">{{ mentorSessionStats.rebooked }}</p>
                    </div>
                    <div>
                        <p class="stat-label">Avg seat fill</p>
                        <p class="stat-value">{{ mentorSessionStats.avgFill }}</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="monthly-chart card">
            <header class="card-header">
                <div>
                    <p class="card-kicker">Month wise sessions</p>
                    <h3>Booked vs Rebooked</h3>
                </div>
            </header>
            <div class="chart-legend">
                <span class="legend-item"><span class="legend-dot blue"></span>Booked</span>
                <span class="legend-item"><span class="legend-dot rose"></span>Rebooked</span>
            </div>
            <div class="monthly-bars">
                <div *ngFor="let month of monthlySessions" class="monthly-col">
                    <div class="monthly-stack">
                        <span class="monthly-bar booked" [style.height.%]="getMonthlyBarHeight(month.booked)"></span>
                        <span class="monthly-bar rebooked"
                            [style.height.%]="getMonthlyBarHeight(month.rebooked)"></span>
                    </div>
                    <p class="bar-label">{{ month.month }}</p>
                    <p class="bar-value">{{ month.booked }} / {{ month.rebooked }}</p>
                </div>
            </div>
        </section>

        <section class="role-section">
            <header class="role-header">
                <div>
                    <p class="card-kicker accent">Personalised view</p>
                    <h3 class="role-title">{{ viewAsMentor ? 'Mentor' : 'Mentee' }} workspace</h3>
                </div>
                <button type="button" class="link switch-role" (click)="toggleWorkspaceView()">
                    Switch role
                </button>
            </header>
            <div class="dashboard-content">
                <app-mentor-dashboard *ngIf="viewAsMentor"></app-mentor-dashboard>
                <app-mentee-dashboard *ngIf="!viewAsMentor"></app-mentee-dashboard>
            </div>
        </section>
    </main>
</div>